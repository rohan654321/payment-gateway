generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model Package {
  id          String   @id @map("_id") @default(auto()) @db.ObjectId
  name        String
  description String
  price       Float
  features    String[] // Stored as JSON
  active      Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  orders      Order[]
}

model User {
  id        String   @id @map("_id") @default(auto()) @db.ObjectId
  firstName String
  lastName  String
  email     String   @unique
  phone     String
  address   String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  orders    Order[]
}

model Order {
  id              String    @id @map("_id") @default(auto()) @db.ObjectId
  user            User      @relation(fields: [userId], references: [id])
  userId          String    @db.ObjectId
  package         Package   @relation(fields: [packageId], references: [id])
  packageId       String    @db.ObjectId
  razorpayOrderId String    @unique
  amount          Float
  currency        String    @default("INR")
  receipt         String
  status          String
  notes           Json?
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt
  payment         Payment[]
}

model Payment {
  id                 String   @id @map("_id") @default(auto()) @db.ObjectId
  order              Order    @relation(fields: [orderId], references: [id])
  orderId            String   @db.ObjectId
  razorpayPaymentId  String   @unique
  razorpaySignature  String
  amount             Float
  status             String
  method             String
  cardDetails        Json?
  walletDetails      Json?
  upiDetails         Json?
  createdAt          DateTime @default(now())
  updatedAt          DateTime @updatedAt
}
